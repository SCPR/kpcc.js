(function(){var t=[].slice,r={}.hasOwnProperty,n=function(t,n){function e(){this.constructor=t}for(var u in n)r.call(n,u)&&(t[u]=n[u]);return e.prototype=n.prototype,t.prototype=new e,t.__super__=n.prototype,t};window.kpcc={API_ROOT:"http://www.scpr.org/api/v3/",NESTED_OBJECTS:{articles:{klass:"Article",plural:!0},segments:{klass:"Article",plural:!0},abstracts:{klass:"Abstract",plural:!0},category:{klass:"Category",plural:!0},assets:{klass:"Asset",plural:!0},audio:{klass:"Audio",plural:!0},attributions:{klass:"Attribution",plural:!0},tags:{klass:"Tag",plural:!0},program:{klass:"Program",plural:!1},location:{klass:"Location",plural:!1},sponsor:{klass:"Sponsor",plural:!1}},api_url:function(){var r;return r=1<=arguments.length?t.call(arguments,0):[],kpcc.API_ROOT+r.join("/")},Query:function(t,r,n){return null==r&&(r={}),$.ajax({type:"GET",dataType:"json",url:kpcc.api_url(t),data:r,success:function(){return function(t){return n.bind(t)(t.meta)}}(this)})}},kpcc.Entity=function(){function t(t){var r,n,e,u,s,i,c,o,a,p,l,_,y;for(_=this.attributes,i=0,a=_.length;a>i;i++)r=_[i],this[r]=t[r];for(y=this.nested_objects,c=0,p=y.length;p>c;c++)if(n=y[c],e=kpcc.NESTED_OBJECTS[n],u=t[n],e&&u)if(e.plural)for(this[n]=[],o=0,l=u.length;l>o;o++)s=u[o],this[n].push(new kpcc[e.klass](s));else this[n]=new kpcc[e.klass](u)}return t.prototype.attributes=[],t.prototype.nested_objects=[],t}(),kpcc.ApiEntity=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return n(r,t),r.ENDPOINT=null,r.KEY_PLURAL=null,r.KEY_SINGULAR=null,r.query=function(t,r){return null==t&&(t={}),this._ajax({url:kpcc.api_url(this.ENDPOINT),data:t,success:function(t){return function(n){return t._collection_cb(n,r)}}(this)})},r.find=function(t,r){return this._ajax({url:kpcc.api_url(this.ENDPOINT,t),success:function(t){return function(n){return t._singular_cb(n,r)}}(this)})},r["default"]=function(t){return this.query({},t)},r._singular_cb=function(t,r){var n;return n=new this(t[this.KEY_SINGULAR]),r.bind(n)(t.meta)},r._collection_cb=function(t,r){var n,e,u,s,i;for(n=[],i=t[this.KEY_PLURAL],u=0,s=i.length;s>u;u++)e=i[u],n.push(new this(e));return r.bind(n)(t.meta)},r._ajax=function(t){return $.ajax($.extend({type:"GET",dataType:"json"},t))},r}(kpcc.Entity),kpcc.Abstract=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return n(r,t),r.prototype.attributes=["source","url","headline","summary","article_published_at"],r.prototype.nested_objects=["assets","audio","category"],r}(kpcc.Entity),kpcc.Alert=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return n(r,t),r.ENDPOINT="alerts",r.KEY_SINGULAR="alert",r.KEY_PLURAL="alerts",r.prototype.attributes=["id","headline","type","published_at","teaser","public_url","mobile_notification_sent","email_notification_sent"],r}(kpcc.ApiEntity),kpcc.Article=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return n(r,t),r.ENDPOINT="articles",r.KEY_SINGULAR="article",r.KEY_PLURAL="articles",r.prototype.attributes=["id","title","short_title","byline","published_at","teaser","body","public_url","thumbnail"],r.prototype.nested_objects=["assets","audio","category","attributions","tags"],r.byUrl=function(t,r){return this._ajax({url:kpcc.api_url(this.ENDPOINT,"by_url"),data:{url:t},success:function(t){return function(n){return t._singular_cb(n,r)}}(this)})},r.mostViewed=function(t){return this._ajax({url:kpcc.api_url(this.ENDPOINT,"most_viewed"),success:function(r){return function(n){return r._collection_cb(n,t)}}(this)})},r.mostCommented=function(t){return this._ajax({url:kpcc.api_url(this.ENDPOINT,"most_commented"),success:function(r){return function(n){return r._collection_cb(n,t)}}(this)})},r}(kpcc.ApiEntity),kpcc.Asset=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return n(r,t),r.prototype.attributes=["id","title","caption","owner","native","thumbnail","small","large","full"],r}(kpcc.Entity),kpcc.Attribution=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return n(r,t),r.prototype.attributes=["name","role_text","role"],r}(kpcc.Entity),kpcc.Audio=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return n(r,t),r.ENDPOINT="audio",r.KEY_SINGULAR="audio",r.KEY_PLURAL="audio",r.prototype.attributes=["id","description","url","byline","uploaded_at","position","duration","filesize","article_obj_key"],r}(kpcc.ApiEntity),kpcc.Blog=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return n(r,t),r.ENDPOINT="blogs",r.KEY_SINGULAR="blog",r.KEY_PLURAL="blogs",r.prototype.attributes=["title","slug","tagline","description","rss_url","public_url"],r.all=r["default"],r}(kpcc.ApiEntity),kpcc.Bucket=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return n(r,t),r.ENDPOINT="buckets",r.KEY_SINGULAR="bucket",r.KEY_PLURAL="buckets",r.prototype.attributes=["title","slug","updated_at"],r.prototype.nested_objects=["articles"],r.all=r["default"],r}(kpcc.ApiEntity),kpcc.Category=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return n(r,t),r.ENDPOINT="categories",r.KEY_SINGULAR="category",r.KEY_PLURAL="categories",r.prototype.attributes=["id","slug","title","public_url"],r.all=r["default"],r}(kpcc.ApiEntity),kpcc.DataPoint=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return n(r,t),r.ENDPOINT="data_points",r.KEY_SINGULAR="data_point",r.KEY_PLURAL="data_points",r.prototype.attributes=["title","group","key","value","notes","updated_at"],r.query=function(t,r){return null==t&&(t={}),this._ajax({url:kpcc.api_url(this.ENDPOINT),data:t,success:function(n){return function(e){return"simple"===t.response_format?r.bind(e[n.KEY_PLURAL])(e.meta):n._collection_cb(e,r)}}(this)})},r}(kpcc.ApiEntity),kpcc.Edition=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return n(r,t),r.ENDPOINT="editions",r.KEY_SINGULAR="edition",r.KEY_PLURAL="editions",r.prototype.attributes=["id","title","published_at"],r.prototype.nested_objects=["abstracts"],r}(kpcc.ApiEntity),kpcc.Episode=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return n(r,t),r.ENDPOINT="episodes",r.KEY_SINGULAR="episode",r.KEY_PLURAL="episodes",r.prototype.attributes=["title","summary","air_date","public_url"],r.prototype.nested_objects=["assets","audio","program","segments"],r}(kpcc.ApiEntity),kpcc.Event=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return n(r,t),r.ENDPOINT="events",r.KEY_SINGULAR="event",r.KEY_PLURAL="events",r.prototype.attributes=["id","title","public_url","starts_at","ends_at","is_all_day","teaser","body","past_tense_body","hashtag","event_type","is_kpcc_event","rsvp_url"],r.prototype.nested_objects=["assets","audio","program","location","sponsor"],r}(kpcc.ApiEntity),kpcc.Location=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return n(r,t),r.prototype.attributes=["title","url","address"],r}(kpcc.Entity),kpcc.Program=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return n(r,t),r.ENDPOINT="programs",r.KEY_SINGULAR="program",r.KEY_PLURAL="programs",r.prototype.attributes=["title","slug","host","air_status","twitter_handle","airtime","description","podcast_url","rss_url","public_url"],r.all=r["default"],r}(kpcc.ApiEntity),kpcc.Schedule=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return n(r,t),r.ENDPOINT="schedule",r.KEY_SINGULAR="schedule_occurrence",r.KEY_PLURAL="schedule_occurrences",r.prototype.attributes=["title","public_url","starts_at","ends_at","is_recurring"],r.prototype.nested_objects=["program"],r.at=function(t,r){return this._ajax({url:kpcc.api_url(this.ENDPOINT,"at"),data:{time:t},success:function(t){return function(n){return t._singular_cb(n,r)}}(this)})},r.find=r.at,r.current=function(t){return this._ajax({url:kpcc.api_url(this.ENDPOINT,"current"),success:function(r){return function(n){return r._singular_cb(n,t)}}(this)})},r}(kpcc.ApiEntity),kpcc.Sponsor=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return n(r,t),r.prototype.attributes=["title","url"],r}(kpcc.Entity),kpcc.Tag=function(t){function r(){return r.__super__.constructor.apply(this,arguments)}return n(r,t),r.ENDPOINT="tags",r.KEY_SINGULAR="tag",r.KEY_PLURAL="tags",r.prototype.attributes=["title","slug"],r.all=r["default"],r}(kpcc.ApiEntity)}).call(this);